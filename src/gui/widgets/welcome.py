# Form implementation generated from reading ui file 'welcome.ui'
#
# Created by: PyQt6 UI code generator 6.8.0
#
# WARNING: Any manual changes made to this file will be lost when pyuic6 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt6 import QtCore, QtGui, QtWidgets
import bindings
from .bootSector.boot_sector import BootSectorTab 

class Ui_MainWindow(object):
    def __init__(self):
        self.boot_sector_tab = None

    def setupUi(self, MainWindow):
        self.main_window = MainWindow
        self.centralwidget = QtWidgets.QWidget(parent=MainWindow)
        self.centralwidget.setObjectName("centralwidget")

        self.frame = QtWidgets.QFrame(parent=self.centralwidget)
        self.frame.setGeometry(QtCore.QRect(20, 20, 1160, 830))
        self.frame.setFrameShape(QtWidgets.QFrame.Shape.StyledPanel)
        self.frame.setFrameShadow(QtWidgets.QFrame.Shadow.Raised)
        self.frame.setObjectName("frame")

        self.label = QtWidgets.QLabel(parent=self.frame)
        self.label.setGeometry(QtCore.QRect(313, 90, 534, 48))
        font = QtGui.QFont()
        font.setPointSize(40)
        self.label.setFont(font)
        self.label.setAlignment(QtCore.Qt.AlignmentFlag.AlignCenter)
        self.label.setObjectName("label")

        self.label_2 = QtWidgets.QLabel(parent=self.frame)
        self.label_2.setGeometry(QtCore.QRect(134, 200, 892, 41))
        font = QtGui.QFont()
        font.setPointSize(28)
        self.label_2.setFont(font)
        self.label_2.setAlignment(QtCore.Qt.AlignmentFlag.AlignCenter)
        self.label_2.setObjectName("label_2")

        self.frame_2 = QtWidgets.QFrame(parent=self.frame)
        self.frame_2.setGeometry(QtCore.QRect(280, 300, 600, 300))
        self.frame_2.setFrameShape(QtWidgets.QFrame.Shape.StyledPanel)
        self.frame_2.setFrameShadow(QtWidgets.QFrame.Shadow.Plain)
        self.frame_2.setObjectName("dottedFrame")

        self.label_3 = QtWidgets.QLabel(parent=self.frame_2)
        self.label_3.setGeometry(QtCore.QRect(102, 100, 396, 34))
        font = QtGui.QFont()
        font.setFamily("Ubuntu Sans")
        font.setPointSize(24)
        self.label_3.setFont(font)
        self.label_3.setAlignment(QtCore.Qt.AlignmentFlag.AlignCenter)
        self.label_3.setObjectName("label_3")

        self.label_4 = QtWidgets.QLabel(parent=self.frame_2)
        self.label_4.setGeometry(QtCore.QRect(267, 150, 66, 19))
        font = QtGui.QFont()
        font.setPointSize(20)
        self.label_4.setFont(font)
        self.label_4.setAlignment(QtCore.Qt.AlignmentFlag.AlignCenter)
        self.label_4.setObjectName("label_4")

        self.pushButton = QtWidgets.QPushButton(parent=self.frame_2)
        self.pushButton.setGeometry(QtCore.QRect(256, 190, 100, 27))
        self.pushButton.setObjectName("pushButton")
        self.pushButton.clicked.connect(self.open_file_dialog)

        self.pushButton_2 = QtWidgets.QPushButton(parent=self.frame)
        self.pushButton_2.setGeometry(QtCore.QRect(500, 640, 160, 60))
        font = QtGui.QFont()
        font.setPointSize(18)
        self.pushButton_2.setFont(font)
        self.pushButton_2.setObjectName("pushButton_2")

        MainWindow.setCentralWidget(self.centralwidget)

        self.actionGenerate = QtGui.QAction(parent=MainWindow)
        self.actionGenerate.setObjectName("actionGenerate")
        self.actionFile = QtGui.QAction(parent=MainWindow)
        self.actionFile.setObjectName("actionFile")
        self.actionPartition = QtGui.QAction(parent=MainWindow)
        self.actionPartition.setObjectName("actionPartition")

        self.retranslateUi(MainWindow)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)
        MainWindow.closeEvent = self.closeEvent


    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "MainWindow"))
        self.label.setText(_translate("MainWindow", "Welcome!"))
        self.label_2.setText(_translate("MainWindow", "To start, select File, drag or generate a NTFS image"))
        self.label_3.setText(_translate("MainWindow", "Drag your NTFS image here"))
        self.label_4.setText(_translate("MainWindow", "or"))
        self.pushButton.setText(_translate("MainWindow", "Examine..."))
        self.pushButton_2.setText(_translate("MainWindow", "Generate"))
        self.actionGenerate.setText(_translate("MainWindow", "Generate"))
        self.actionFile.setText(_translate("MainWindow", "File"))
        self.actionPartition.setText(_translate("MainWindow", "Partition"))

    def open_file_dialog(self):
        file_dialog = QtWidgets.QFileDialog()
        file_path, _ = file_dialog.getOpenFileName(None, "Select NTFS Image", "", "All Files (*);;NTFS Images (*.img *.bin)")
        if file_path:
            is_valid_image = bindings.read_image(file_path)
            if is_valid_image:
                self.main_window.go_to_tabs()
                self.main_window.tabs.set_current_tab("Boot Sector")
                boot_sector_tab = self.main_window.tabs.get_boot_sector_tab() 
                if boot_sector_tab:
                    boot_sector_tab.show_boot_sector_data()

    def closeEvent(self, event):
        bindings.close_image()
        event.accept()